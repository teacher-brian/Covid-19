mutate(new_cases=count-lag(count)) %>%
#   arrange(desc(count)) %>%
group_by(Province_State,Date) %>%
ggplot(aes(Date,new_cases)) -> p
p+geom_point(shape=18)+
geom_line(alpha=.2)+
#geom_smooth(se=F)+
facet_wrap(~Province_State)
p+geom_point(shape=18)+
geom_line(alpha=.2)+
#geom_smooth(se=F)+
facet_wrap(~Province_State)
p+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-24',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
#   arrange(desc(count)) %>%
group_by(Province_State,Date) %>%
ggplot(aes(Date,new_cases)) -> p
p+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-24',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-24',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
source('~/Projects/Psych217/ZipFilePractice/scripts/covid_US_cases_exporatory_graphs.r', echo=TRUE)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>% print(.,n=100)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,Province_State == "New York")# %>%
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,Province_State == "New York")# %>%
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000,Province_State == "New York")# %>%
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000,Province_State == "New York") %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000,Province_State=='New York') %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000,Province_State=='New York') %>% summarise(total_new=sum(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-23',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-25',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-26',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>1,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
source('~/Projects/Psych217/ZipFilePractice/scripts/covid_US_cases_exporatory_graphs.r', echo=TRUE)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0,new_cases<10000) %>% summarise(new_cases=sum(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0,new_cases<10000) %>% summarise(new_cases=sum(new_cases)) %>% arrange(desc(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>% summarise(new_cases=sum(new_cases)) %>% arrange(desc(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>% summarise(new_cases=sum(new_cases)) %>% filter(new_cases<10000) %>% arrange(desc(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>%
filter(new_cases<10000) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
library(tidyverse)
library(lubridate)
library(here)
covid_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_US.csv',stringsAsFactors = F)
#write.csv(covid_us,file='./data/covid_US_deaths_raw.csv')
recent_date <- colnames(covid_us)[length(covid_us)]
write.csv(covid_us,file='./data/covid_US_deaths_raw.csv')
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>% print(.,n=15)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>%
filter(new_cases<10000) #%>%
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>%
filter(new_cases<10000) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>% filter(Province_State=='New York')
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20',count>1000) %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>% filter(Province_State=='New York')
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20') %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Country_Region)) %>%
filter(Date>='2020-04-20') %>%
group_by(Province_State) %>%
mutate(new_cases=count-lag(count)) %>%
group_by(Province_State,Date) %>%
filter(new_cases>0) %>%
summarise(new_cases=sum(new_cases)) %>%
filter(new_cases<11000) %>%
ggplot(aes(Date,new_cases))+geom_point(shape=18)+
#geom_line(alpha=.2)+
geom_smooth(se=F)+
facet_wrap(~Province_State)+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
library(tidyverse)
library(lubridate)
library(here)
covid_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_US.csv',stringsAsFactors = F)
write.csv(covid_us,file='./data/covid_US_deaths_raw.csv')
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
# all us state and then some
drop_state <- c("New York","Massachusetts")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20") %>% #,!Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count)) %>%
group_by(Date,Province_State) %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~Province_State)+
ggtitle("new cases in the States since 4/21")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20"Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count)) %>%
group_by(Date,Province_State)
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20"Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count))
# all us state and then some
drop_state <- c("New York","Massachusetts")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20"Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20",Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count))
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20",!Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count)) %>%
group_by(Date,Province_State) %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~Province_State)+
ggtitle("new cases in the States since 4/21")
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
library(here)
library(tidyverse)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
covid_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_us)[length(covid_us)]
write.csv(covid_us,file='./data/covid_US_deaths_raw.csv')
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
library(tidyverse)
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
library(lubridate)
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
# all us state and then some
drop_state <- c("New York","Massachusetts")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20",!Province_State %in% drop_state) %>%
mutate(new_cases= count-lag(count)) %>%
group_by(Date,Province_State) %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~Province_State)+
ggtitle("new cases in the States since 4/21")
