summarise(total=sum(count)) %>%
ggplot(aes(x=Date,y=total,label=total))+geom_point(size=.5)+
geom_text(aes(label=ifelse(Date==today,total,'')),hjust=1.5,vjust=.5)+
ggtitle(paste0('total cases as of\n',today))+
scale_y_continuous(labels = scales::comma)
cg %>%
group_by(Country.Region,Date) %>% filter(Date == today) %>%
filter(Province.State=="") %>%
summarise(total=sum(count)) %>%
arrange(desc(total)) %>%
summarise(grand_tot=sum(total)) %>% arrange(desc(grand_tot)) %>%
print(.,n=400)
today <- drop_x(recent_date)
str(cg)
cg %>%
filter(Date==today) %>%
#group_by(Date) %>%
summarise(total=sum(count))
covid_cases_global <- read.csv(here::here("./COVID-19/csse_covid_19_data/csse_covid_19_time_series/","time_series_covid19_confirmed_global.csv"),stringsAsFactors = F)
cg<- covid_cases_global
head(cg)
# tidy up the data for graphing
recent_date <- colnames(cg)[length(cg)]
head(cg)
str(cg)
countryID_dates<- cg %>%
#select(Country.Region, Province.State,Lat, Long,X1.22.20:recent_date) %>%
gather(key = Date, value= count,-c(Country.Region,Lat,Long,Province.State))
cg_tidy<-countryID_dates %>% mutate(Date=gsub("X","",Date))
str(cg_tidy)
#Use lapply() to coerce and replace the chosen columns:
cg_tidy$Country.Region <-  factor(cg_tidy$Country.Region)
cg_tidy$Province.State <-  factor(cg_tidy$Province.State)
cg_tidy$Date<- mdy(cg_tidy$Date)
str(cg_tidy)
write.csv(cg_tidy,file='./data/covid_global_cases_tidy.csv')
cg<- read.csv(here::here('data',file='./covid_global_cases_tidy.csv'),stringsAsFactors = F)
cg$Country.Region <- as.factor(cg$Country.Region)
cg$Province.State <-  factor(cg$Province.State)
cg$Date <- ymd(cg$Date)
str(cg)
today <- drop_x(recent_date)
cg %>%
filter(Date==today) %>%
#group_by(Date) %>%
summarise(total=sum(count))
countries.of.interest <- c('Sweden', 'Korea, South','US',"United Kingdom","France")
sk.pop <- 51e6
US.pop <- 330e6
sw.pop <- 10e6
uk.pop <- 68e6
fr.pop <- 65e6
cg %>%
group_by(Country.Region) %>%
filter(Country.Region %in% countries.of.interest) %>%
filter(Province.State=="") %>%
mutate(proportion=case_when(Country.Region=='Sweden'~ count/sw.pop,
Country.Region=='Korea, South'~ count/sk.pop,
Country.Region=='US'~ count/US.pop,
Country.Region=='France'~ count/fr.pop,
Country.Region=='United Kingdom'~ count/uk.pop
)
) %>%
ggplot(aes(x=Date,proportion))+geom_point(size=.1)+facet_wrap(~Country.Region)
# no proport
cg %>%
group_by(Country.Region) %>%
filter(Country.Region %in% countries.of.interest) %>%
filter(Province.State=="") %>%
# filter(Date>'2020-01-01',Date<'2020-02-05') %>%
ggplot(aes(x=Date,count))+geom_point(size=.1)+facet_wrap(~Country.Region,scales='free')
cg %>%
group_by(Date) %>%
summarise(total=sum(count)) %>%
ggplot(aes(x=Date,y=total,label=total))+geom_point(size=.5)+
geom_text(aes(label=ifelse(Date==today,total,'')),hjust=1.5,vjust=.5)+
ggtitle(paste0('total cases as of\n',today))+
scale_y_continuous(labels = scales::comma)
cg %>%
group_by(Country.Region,Date) %>% filter(Date == today) %>%
filter(Province.State=="") %>%
summarise(total=sum(count)) %>%
arrange(desc(total)) %>%
summarise(grand_tot=sum(total)) %>% arrange(desc(grand_tot)) %>%
print(.,n=400)
covid_us <- read.csv(here::here("data","covid_US_deaths_raw.csv"), stringsAsFactors = F)
recent_date <- colnames(covid_us)[length(covid_us)]
head(covid_us)
str(covid_us)
unique(covid_us$Province_State)
UID_dates<- covid_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_us %>% select(-c(X1.22.20:recent_date))
covid_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_tidy<-covid_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_tidy)
cols<- names(covid_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_tidy[cols] <- lapply(covid_tidy[cols], factor)  ## as.factor() could also be used
covid_tidy$Date<- mdy(covid_tidy$Date)
str(covid_tidy)
covid_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
covid_tidy %>% filter(Province_State=="Washington",Admin2=="King"|Admin2=="Spokane",count>0) %>% group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date) %>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_smooth(se=F)
covid_tidy %>% filter(Province_State=="Washington",Admin2=="King"|Admin2=="Spokane"|Admin2=="Snohomish",count>0) %>% group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_deaths=count-count_lag) %>% group_by(Date) %>%
ggplot(aes(Date,new_deaths,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',alpha=.5)+geom_line(stat='smooth',alpha=.5)+
ggtitle("Daily reporting of Fatalities")
drop_state <- c("New York","Massachusetts")
covid_tidy %>%
select(-c(iso2:FIPS,Admin2,Country_Region)) %>%
group_by(Province_State,Date) %>%
summarise(count=sum(count,na.rm=T)) %>%
filter(Date>"2020-04-20") %>% #,!Province_State %in% drop_state) %>%
mutate(new_deaths= count-lag(count)) %>%
group_by(Date,Province_State) %>%
ggplot(aes(x=Date,new_deaths))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~Province_State,scales = 'free')+
ggtitle("new cases in the States since 4/21")
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(Date>today()-21,Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
wa.new.cases[,c(3,12)] <- lapply(wa.new.cases[,c(3,12)],function(x) factor(x))
lapply(wa.new.cases[,c('Admin2','sort.Admin2')], levels)
wa.new.cases[,12] <- factor(wa.new.cases$Admin2,levels = wa.new.cases$Admin2[1:41], ordered = T)
wa.new.cases %>%
ggplot(aes(Date,new_cases))+
geom_point(shape=18)+geom_line(alpha=.2)+geom_smooth(se=F)+
facet_wrap(~sort.Admin2,scales = 'free')
# all us state and then some
drop_ship <- c("Diamond Princess","Grand Princess")
drop_state <- c("New Jersey","New York","Massachusetts","California",)
protest_states <- c("Minnesota","Texas","Colorado","Michigan","Illinois",
"Wisconsin","Ohio","Mississippi","North Carolina","Alabama","Arizona")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,
Admin2,
Country_Region)) %>%
group_by(Province_State,
#Admin2,
Date) %>%
summarise(count = sum(count, na.rm = T)) %>%
filter(Date > "2020-04-20", !Province_State %in% drop_ship) %>%
#filter(!Province_State %in% drop_state) %>%
#filter(Province_State %in% protest_states) %>%
mutate(new_cases = count - lag(count)) %>%
group_by(Date, Province_State) %>% arrange(desc(Date), desc(new_cases)) %>%
mutate(sort_state = factor(Province_State))  -> tmp
tmp[,c(1,5)] <- lapply(tmp[,c(1,5)],function(x) factor(x))
lapply(tmp[,c('Province_State','sort_state')], levels)
tmp[,5] <- factor(tmp$Province_State,levels = tmp$Province_State[1:56], ordered = T)
tmp %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~sort_state,scales = 'free')+
ggtitle("new cases in the States since 4/21\nBlue simple linear regression, pink with , loess")+
geom_smooth(method='lm',color='blue',se=F)+
geom_smooth(color='pink',size=.6)
tmp %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~sort_state,scales = 'fixed')+
ggtitle("new cases in the States since 4/21\nBlue simple linear regression, pink with , loess")+
geom_smooth(method='lm',color='blue',se=F)+
geom_smooth(color='pink',size=.6)
library(tidyverse)
library(lubridate)
library(here)
covid_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_us)[length(covid_us)]
write.csv(covid_us,file='./data/covid_US_deaths_raw.csv')
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
library(tidyverse)
library(lubridate)
library(here)
covid_glob_death <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv',stringsAsFactors = F)
#write.csv(covid_glob_death,file='./data/covid_global_deaths_raw.csv')
recent_date <- colnames(covid_glob_death)[length(covid_glob_death)]
recent_date
write.csv(covid_glob_death,file='./data/covid_global_deaths_raw.csv')
library(tidyverse)
library(lubridate)
# function to strip X from date and conver to lubridate
drop_x <- function(x){
y <- gsub("X","",x)
y <- mdy(y)
return(y)
}
covid_cases_global <- read.csv(here::here("./COVID-19/csse_covid_19_data/csse_covid_19_time_series/","time_series_covid19_confirmed_global.csv"),stringsAsFactors = F)
cg<- covid_cases_global
head(cg)
# tidy up the data for graphing
recent_date <- colnames(cg)[length(cg)]
recent_date
head(cg)
countryID_dates<- cg %>%
#select(Country.Region, Province.State,Lat, Long,X1.22.20:recent_date) %>%
gather(key = Date, value= count,-c(Country.Region,Lat,Long,Province.State))
cg_tidy<-countryID_dates %>% mutate(Date=gsub("X","",Date))
str(cg_tidy)
#Use lapply() to coerce and replace the chosen columns:
cg_tidy$Country.Region <-  factor(cg_tidy$Country.Region)
cg_tidy$Province.State <-  factor(cg_tidy$Province.State)
cg_tidy$Date<- mdy(cg_tidy$Date)
str(cg_tidy)
write.csv(cg_tidy,file='./data/covid_global_cases_tidy.csv')
cg<- read.csv(here::here('data',file='./covid_global_cases_tidy.csv'),stringsAsFactors = F)
cg$Country.Region <- as.factor(cg$Country.Region)
cg$Province.State <-  factor(cg$Province.State)
cg$Date <- ymd(cg$Date)
str(cg)
# total as of today
today <- drop_x(recent_date)
cg %>%
filter(Date==today) %>%
#group_by(Date) %>%
summarise(total=sum(count))
countries.of.interest <- c('Sweden', 'Korea, South','US',"United Kingdom","France")
sk.pop <- 51e6
US.pop <- 330e6
sw.pop <- 10e6
uk.pop <- 68e6
fr.pop <- 65e6
cg %>%
group_by(Country.Region) %>%
filter(Country.Region %in% countries.of.interest) %>%
filter(Province.State=="") %>%
mutate(proportion=case_when(Country.Region=='Sweden'~ count/sw.pop,
Country.Region=='Korea, South'~ count/sk.pop,
Country.Region=='US'~ count/US.pop,
Country.Region=='France'~ count/fr.pop,
Country.Region=='United Kingdom'~ count/uk.pop
)
) %>%
ggplot(aes(x=Date,proportion))+geom_point(size=.1)+facet_wrap(~Country.Region)
# no proport
cg %>%
group_by(Country.Region) %>%
filter(Country.Region %in% countries.of.interest) %>%
filter(Province.State=="") %>%
# filter(Date>'2020-01-01',Date<'2020-02-05') %>%
ggplot(aes(x=Date,count))+geom_point(size=.1)+facet_wrap(~Country.Region,scales='free')
cg %>%
group_by(Date) %>%
summarise(total=sum(count)) %>%
ggplot(aes(x=Date,y=total,label=total))+geom_point(size=.5)+
geom_text(aes(label=ifelse(Date==today,total,'')),hjust=1.5,vjust=.5)+
ggtitle(paste0('total cases as of\n',today))+
scale_y_continuous(labels = scales::comma)
cg %>%
group_by(Country.Region,Date) %>% filter(Date == today) %>%
filter(Province.State=="") %>%
summarise(total=sum(count)) %>%
arrange(desc(total)) %>%
summarise(grand_tot=sum(total)) %>% arrange(desc(grand_tot)) %>%
print(.,n=400)
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
recent_date
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(Date>today()-21,Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
wa.new.cases[,c(3,12)]
wa.new.cases[,c(3,12)] <- lapply(wa.new.cases[,c(3,12)],function(x) factor(x))
lapply(wa.new.cases[,c('Admin2','sort.Admin2')], levels)
wa.new.cases[,12] <- factor(wa.new.cases$Admin2,levels = wa.new.cases$Admin2[1:41], ordered = T)
wa.new.cases %>%
ggplot(aes(Date,new_cases))+
geom_point(shape=18)+geom_line(alpha=.2)+geom_smooth(se=F)+
facet_wrap(~sort.Admin2,scales = 'free')
# all us state and then some
drop_ship <- c("Diamond Princess","Grand Princess")
drop_state <- c("New Jersey","New York","Massachusetts","California",)
protest_states <- c("Minnesota","Texas","Colorado","Michigan","Illinois",
"Wisconsin","Ohio","Mississippi","North Carolina","Alabama","Arizona")
covid_US_cases_tidy %>%
select(-c(iso2:FIPS,
Admin2,
Country_Region)) %>%
group_by(Province_State,
#Admin2,
Date) %>%
summarise(count = sum(count, na.rm = T)) %>%
filter(Date > "2020-04-20", !Province_State %in% drop_ship) %>%
#filter(!Province_State %in% drop_state) %>%
#filter(Province_State %in% protest_states) %>%
mutate(new_cases = count - lag(count)) %>%
group_by(Date, Province_State) %>% arrange(desc(Date), desc(new_cases)) %>%
mutate(sort_state = factor(Province_State))  -> tmp
tmp[,c(1,5)] <- lapply(tmp[,c(1,5)],function(x) factor(x))
lapply(tmp[,c('Province_State','sort_state')], levels)
tmp[,5] <- factor(tmp$Province_State,levels = tmp$Province_State[1:56], ordered = T)
tmp %>%
ggplot(aes(x=Date,new_cases))+ geom_point(size=.2)+
geom_line()+
facet_wrap(~sort_state,scales = 'fixed')+
ggtitle("new cases in the States since 4/21\nBlue simple linear regression, pink with , loess")+
geom_smooth(method='lm',color='blue',se=F)+
geom_smooth(color='pink',size=.6)
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
#wa.new.cases %>%
wa.new.cases[,c(3,12)] <- lapply(wa.new.cases[,c(3,12)],function(x) factor(x))
lapply(wa.new.cases[,c('Admin2','sort.Admin2')], levels)
wa.new.cases[,12] <- factor(wa.new.cases$Admin2,levels = wa.new.cases$Admin2[1:41], ordered = T)
wa.new.cases
wa.new.cases
wa.new.cases %>% select(Admin2="King|Snohomish")
wa.new.cases %>% filter(Admin2="King|Snohomish")
wa.new.cases %>% filter(Admin2="King")
wa.new.cases
wa.new.cases %>% filter(Admin2="King")
wa.new.cases %>% filter(Admin2=="King|")
wa.new.cases %>% filter(Admin2=="King")
wa.new.cases %>% filter(Admin2=="King|Snohomish")
wa.new.cases %>% filter(Admin2=="King",Admin2=="Snohomish")
wa.new.cases %>% filter(Admin2=="King")
wa.new.cases %>% filter(Admin2=="King") %>% select(count)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new.cases)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(weekly_variable=rep(1:7))
rep(1:7)
rep(1:7,2)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% print(n=60)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% do.call(cbind(ymd(week))
)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% do.call(cbind(ymd(week)))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% ggplot(x=week,y=summarise(mean_count=mean(new_cases,na.rm=T)))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% ggplot(x=week,y=summarise(mean_count=mean(new_cases,na.rm=T)))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% ggplot(x=Date,y=summarise(mean_count=mean(new_cases,na.rm=T)))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% ggplot(aes(x=week,y=summarise(mean_count=mean(new_cases,na.rm=T))))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% ggplot(aes(x=week,y=new_cases))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)
)
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=Date,y=mean_new))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()
ymd(1:10)
wa.new.cases$Date
week(wa.new.cases$Date)
ymd(week(wa.new.cases$Date))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date))
wa.new.cases %>% filter(Admin2=="King") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King|Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King"|"Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% print(n=60)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% print(n=90)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=sum_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases$Date
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=paste0("2020-",week,"-01"))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01")))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01"))) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01"))) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01")))
week(20)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))%>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))%>% ggplot(aes(x=Date,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2,Date) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2,Date) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T),new_cases=new_cases) %>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date))+geom_point(aes(x=week,y=mean_new))+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+geom_point(data=wa.new.cases,aes(x=Date,y=new_cases,color='blue'))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+geom_point(data=wa.new.cases,aes(x=group_by(Date),y=new_cases,color='blue'))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases,size=.1))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=new_cases,color='blue'))
weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=mean_new,color='blue'))
