wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% print(n=90)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=sum_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases$Date
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=paste0("2020-",week,"-01"))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01")))
wa.new.cases %>% filter(Admin2=="King"|Admin2=="Snohomish") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01"))) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01"))) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+facet_wrap(~Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(week=ymd(paste0("2020-",week,"-01")))
week(20)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))%>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))%>% ggplot(aes(x=Date,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2,Date) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2,Date) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T),new_cases=new_cases) %>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=Date))+geom_point(aes(x=week,y=mean_new))+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+geom_point(data=wa.new.cases,aes(x=Date,y=new_cases,color='blue'))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2) %>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% ggplot(aes(x=week,y=mean_new))+geom_point()+geom_line()+geom_smooth()+geom_point(data=wa.new.cases,aes(x=group_by(Date),y=new_cases,color='blue'))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point()+geom_line()+geom_smooth()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases,size=.1))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=new_cases,color='blue'))
weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=mean_new,color='blue'))
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=mean_new,color='blue'))
wa.new.cases[,c(3,12)] <- lapply(wa.new.cases[,c(3,12)],function(x) factor(x))
lapply(wa.new.cases[,c('Admin2','sort.Admin2')], levels)
wa.new.cases[,12] <- factor(wa.new.cases$Admin2,levels = wa.new.cases$Admin2[1:41], ordered = T)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=week,y=mean_new,color='blue'))
weekly_king
weekly_king %>% mutate(d=ymd("2020-0-1-01")+week)
warnings()
weekly_king %>% mutate(d=ymd("2020-0-1-01"))
weekly_king %>% mutate(d=ymd("2020-01-01"))
weekly_king %>% mutate(d=ymd("2020-01-01")+week)
weekly_king %>% mutate(d=ymd("2020-01-01")+weeks(week))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week)) %>%
ggplot(aes(x=d,y=mean_new))+geom_point()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new,color='blue'))
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue')
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.2)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.6)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_line(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_line(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_errorbar()
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1,shape=5)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1,type=5)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.8, shape=3)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=3)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=2)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=9)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
head(covid_cases_us)
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
View(UID_dates)
View(UID_info)
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
View(UID_dates)
covid_cases_us
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
covid_cases_us
covid_cases_us
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% ggplot(aes(x=Date,y=new_cases))+geom_point(size=.1) + geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(size=.1)
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)
weekly_king
wa.new.cases %>%
ggplot(aes(Date,new_cases))+
geom_point(shape=18)+geom_line(alpha=.2)+geom_smooth(se=F)+
facet_wrap(~sort.Admin2,scales = 'free')
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
covid_US_cases_tidy %>% select(Admin2,Date,count)
covid_US_cases_tidy %>% select(Admin2,Date,count) %>% filter(Date=="2020-04-12")
covid_US_cases_tidy %>% select(Admin2,Date,count) %>% filter(Date=="2020-04-12",Admin2=="King")
covid_US_cases_tidy %>% select(State,Admin2,Date,count) %>% filter(Date=="2020-04-12",Admin2=="King")
names(covid_US_cases_tidy )
covid_US_cases_tidy %>% select(Province_state,Admin2,Date,count) %>% filter(Date=="2020-04-12",Admin2=="King")
covid_US_cases_tidy %>% select(Province_State,Admin2,Date,count) %>% filter(Date=="2020-04-12",Admin2=="King")
covid_US_cases_tidy %>% select(Province_State,Admin2,Date,count) %>% filter(Date=="2020-04-12",Province_State=="Washington",Admin2=="King")
covid_US_cases_tidy %>% select(Province_State,Admin2,Date,count) %>% filter(Date=="2020-04-12",Province_State=="Washington")
covid_US_cases_tidy %>% select(Province_State,Admin2,Date,count) %>% filter(Date=="2020-04-12",Province_State=="Washington") %>% summarise(sum(count))
642/506
642*6.05
642/6.05
642/.0605
642/10609
10609/1240.031828
93615/1240.031828
10609/93615
93615/10609
102913/2360387
(102913/2360387)^-1
2360387/102913
140.8720663077597/10635
10635/140.8720663077597
140.8720663077597/1e5
140.8720663077597/1e5/10635
140.8720663077597*1e5/10635
1/(140.8720663077597/1e5)
8e6
8e6/8
8e6/1000000
8e6/1e5
7e4/8e6
*1e5
7e4/8e6*1e5
10609/x*1e5=140.53
(140.53/1e5/10609)^-1
(140.5276682/1e5/10609)^-1
(140.8720663077597/1e5/10635)^-1
(30996.981835463746/1e5/2360387.0)^-1
(1242.5088447391138/1e5/93802)^-1
dir()
library(here)
library(tidyverse)
library(lubridate)
getwd()
files <- list.files(path = "./COVID-19/csse_covid-19_data/csse_covid-19_daily_reports_us",pattern="*.csv")
files
?list.files
list.files(path = "./COVID-19/csse_covid-19_data/csse_covid-19_daily_reports_us")
setwd("~/Projects/Psych217/ZipFilePractice/COVID-19/csse_covid_19_data/csse_covid_19_daily_reports_us")
list.files()
getwd()
dir()
dir(pattern = "*.csv")
list.files(pattern = "*.csv")
list.files()
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(size=.1) +
geom_point(data=weekly_king,aes(x=d,y=mean_new),color='blue', shape=18)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),color='blue',size=.1)
library(tidyverse)
library(lubridate)
library(forcats)
# read US Cases into Rstudio ----------------------------------------------
glimpse("/home/brian/Zotero/zotero.sqlite")
?glimpse
read_lines(file = "/home/brian/Zotero/zotero.sqlite",n_max = 20)
read_lines(file = "/home/brian/Zotero/zotero.sqlite",n_max = 200)
View(covid_cases_us)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
#recent_date1 <- colnames(covid_cases_us)[length(covid_cases_us)]
#if (rescent_date1<=recent_date)
#write.csv(covid_c
str(covid_cases_us)
covid_cases_us %>% select(filter(Province_State=="Washington"),Combined_Key)
covid_cases_us %>% select(Province_State,Combined_Key)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key,Lat,Lon)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key,Lat,Long_)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key,Lat,Long_,iso2)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key,Lat,Long_,iso3)
covid_cases_us %>% filter(Province_State=="Washington") %>% select(Combined_Key,Lat,Long_,Admin2)
str(covid_cases_us)
