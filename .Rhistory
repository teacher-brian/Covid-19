x= "2020-10-01",
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-09-10"),
y = 750
)
10
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-03-10"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>% select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
geom_point(data=weekly_king %>% filter(d<="2020-11-18"),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
ymd(today())
wa.new.cases %>% filter(Admin2=="King",Date<"2020-11-13") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king %>% filter(d<=ymd(today())),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king %>% filter(d<=ymd(today())),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king,aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
ymd(today())
weekly_king %>% filter(d<=ymd(today()))
weekly_king %>% filter(d<=ymd(today())) %>% print(.,n=100)
weekly_king
weekly_king %>% print(.,n=100)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king %>% filter(d<=ymd(today()+2)),aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") #%>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15") %>%
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd(today())) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15")) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15")) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1)
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
library(tidyverse)
library(lubridate)
library(forcats)
library(viridis)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King",Date<=ymd("2020-10-15")) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
wa.new.cases %>% filter(Admin2=="King",
#Date<=ymd("2020-10-15")
) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
library(here)
library(tidyverse)
library(lubridate)
covid_cases_us <- read.csv(file='./COVID-19/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_US.csv',stringsAsFactors = F)
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
write.csv(covid_cases_us,file='./data/covid_US_cases_raw.csv')
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
library(tidyverse)
library(lubridate)
library(forcats)
library(viridis)
# read US Cases into Rstudio ----------------------------------------------
covid_cases_us <- read.csv(here::here("data","covid_US_cases_raw.csv"),stringsAsFactors = F)
# tidy up the data for graphing
recent_date <- colnames(covid_cases_us)[length(covid_cases_us)]
head(covid_cases_us)
str(covid_cases_us)
UID_dates<- covid_cases_us %>% select(UID,X1.22.20:recent_date) %>% gather(key = Date, value= count,-UID)
UID_info<- covid_cases_us %>% select(-c(X1.22.20:recent_date))
covid_US_cases_tidy<- left_join(UID_info,UID_dates,by="UID")
covid_US_cases_tidy<-covid_US_cases_tidy %>% mutate(Date=gsub("X","",Date))
str(covid_US_cases_tidy)
cols<- names(covid_US_cases_tidy[c(1:8,11)])
#Use lapply() to coerce and replace the chosen columns:
covid_US_cases_tidy[cols] <- lapply(covid_US_cases_tidy[cols], factor)  ## as.factor() could also be used
covid_US_cases_tidy$Date<- mdy(covid_US_cases_tidy$Date)
str(covid_US_cases_tidy)
#write.csv(covid_US_cases_tidy,file='./data/covid_US_cases_tidy.csv')
#covid_US_cases_tidy<- read.csv(file='./data/covid_US_cases_tidy.csv')
# list of counties in Washington
covid_US_cases_tidy %>% filter(Province_State=="Washington") %>% group_by(Admin2) %>%
summarise(m=max(count)) %>% arrange(desc(m))
# total cumulative cases in Washington state, King and Spkane county
covid_US_cases_tidy %>% filter(Province_State=="Washington"#,
#Admin2=="King"|
# Admin2=="Spokane"|
#Admin2=="Snohomish",count>01
) %>%
group_by(Admin2) %>%
arrange(desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>% group_by(Date)%>%
ggplot(aes(Date,count,color=Admin2))+geom_point(shape=18)+
geom_line(stat='smooth',se=F,alpha=.6)+
facet_wrap(~Admin2,scales='free')
new.cases <- c("Adams",'Benton','Grant', 'Clark', 'Franklin','Skagit','Spokane','Thurston','Walla Walla','Yakima',"King")
covid_US_cases_tidy %>% filter(#Date>today()-21,
Province_State=='Washington') %>%
#filter(Admin2 == "King" |Admin2 %in% new.cases) %>%
group_by(Admin2) %>%
arrange(-desc(Date)) %>% select(-c(iso2:FIPS,Country_Region)) %>%
mutate(count_lag=lag(count,1),new_cases=count-count_lag) %>% group_by(Date) %>%
arrange(desc(Date),desc(new_cases)) %>%
mutate(sort.Admin2=factor(Admin2))-> wa.new.cases#
# The following compares snohomish and king on average weekly new  --------
wa.new.cases %>% filter(Admin2=="King") %>% select(Admin2,count,count_lag,new_cases) %>% mutate(week=week(Date)) %>% group_by(week,Admin2)%>% summarise(mean_new=mean(new_cases,na.rm=T),sum_new=sum(new_cases,na.rm=T)) %>% mutate(d=ymd("2020-01-01")+weeks(week))->weekly_king
wa.new.cases %>% filter(Admin2=="King",
#Date<=ymd("2020-10-15")
) %>%
# consdier changing date filter above
select(Admin2,count,count_lag,new_cases,Date) %>%
mutate(week=week(Date)) %>%
group_by(week,Admin2) %>%
ggplot(aes(x=Date,y=new_cases))+
geom_point(color='magenta',size=.1) +
# consdier changing date filter below
geom_point(data=weekly_king# %>% filter(d<=ymd(today()))
,
aes(x=d,y=mean_new),color='royalblue3',shape=18,size=1.5)+
geom_smooth(data=weekly_king,aes(x=d,y=mean_new),se = F, color='blue',          size=.1)+
ggtitle("King County, WA\npink =  daily cases\n blue =  weekly average")+
geom_vline(xintercept=ymd("2020-11-03"))+
geom_label(label="election 11/3 --->",
x= ymd("2020-10-10"),
y = 750
)+
geom_vline(xintercept=ymd("2020-02-29"))+
geom_label(label="<-- first stay at home order",
x= ymd("2020-04-01"),
y = 750
)
